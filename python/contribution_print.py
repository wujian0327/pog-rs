import numpy as np
from scipy import stats
import matplotlib.pyplot as plt
import seaborn as sns

np.random.seed(42)
x = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2,
     2, 2, 2, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 4, 5, 6, 6, 6, 6, 17, 17, 41]
y = [0.46777354139487437, 0.46777354139487437, 0.6839397205857212, 0.6839397205857212, 0.6839397205857212,
     1.0032147244080551, 1.0032147244080551, 1.1839397205857212, 1.1839397205857212, 1.1839397205857212,
     1.2357588823428847, 1.2357588823428847, 1.2357588823428847, 1.2357588823428847, 1.309743401687735,
     1.3678794411714423, 1.3678794411714423, 1.3678794411714423, 1.36948680337547, 1.3710941655794975,
     1.3710941655794975, 1.3710941655794975, 1.4196986029286058, 1.4196986029286058, 1.4196986029286058,
     1.553426523961191, 1.6319545790199406, 1.6319545790199406, 1.673312983548163, 1.7030341600329386,
     1.7357588823428847, 1.7357588823428847, 1.8484829584371898, 1.9062567976944949, 1.9196986029286058,
     2.0086254337721154, 2.082550829247828, 2.082550829247828, 2.1486111086621067, 2.1839397205857214,
     2.243683122273456, 2.340196518280216, 2.419698602928606, 2.427124579154357, 2.5658942996056617, 2.7044443072503297,
     2.919698602928606, 2.9293427761527715, 2.9293427761527715, 2.9293427761527715, 2.9293427761527715,
     2.9293427761527715, 2.933773740777104, 3.064399730880023, 3.1001063385008094, 3.1108670847534414,
     3.4293427761527715, 3.4446341542175474, 3.602884212558875, 3.8312158683586053]
# x = np.arange(0, 10, 0.5)
# y = x ** 2 + np.random.normal(0, 5, len(x))  # x的平方加随机噪声
correlation, p_value = stats.spearmanr(x, y)

# 设置字体和风格
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False
sns.set_theme(style="whitegrid")

# 绘制散点图
plt.figure(figsize=(10, 6))
sns.scatterplot(x=x, y=y, color='dodgerblue', edgecolor='k', alpha=0.7, label='data')

# 添加局部回归趋势线
sns.regplot(x=x, y=y, lowess=False, scatter=False, color='red', label='trend')

# 添加标题和标签
plt.title(f'Spearman = {correlation:.2f} (p = {p_value:.3f})', fontsize=14)
plt.xlabel('X', fontsize=12)
plt.ylabel('Y', fontsize=12)
plt.legend()

plt.tight_layout()
plt.show()
